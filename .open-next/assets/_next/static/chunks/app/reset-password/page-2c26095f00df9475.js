(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[700],{1433:(e,r,s)=>{Promise.resolve().then(s.bind(s,4622))},3426:(e,r,s)=>{"use strict";s.d(r,{Ay:()=>g,Au:()=>h,Bi:()=>c,ms:()=>u,ug:()=>i});var a=s(5327);let t={signup:async e=>a.u.post("/auth/signup",e),login:async e=>a.u.post("/auth/login",e),resetPassword:async e=>a.u.post("/auth/reset-password",e),forgotPassword:async e=>a.u.post("/auth/forgot-password",e),logout:async()=>a.u.post("/auth/logout")};var o=s(9945),n=s(1990),l=s(7383);let d={expires:30,secure:!0},i=(0,n.zD)("auth/signup",async(e,r)=>{try{let r=await t.signup(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(s){let{error:e}=(0,o.h)(s);return r.rejectWithValue(e)}}),c=(0,n.zD)("auth/login",async(e,r)=>{try{let r=await t.login(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(s){let{error:e}=(0,o.h)(s);return r.rejectWithValue(e)}}),u=(0,n.zD)("auth/resetPassword",async(e,r)=>{try{let r=await t.resetPassword(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(s){let{error:e}=(0,o.h)(s);return r.rejectWithValue(e)}}),h=(0,n.zD)("auth/forgotPassword",async(e,r)=>{try{let r=await t.forgotPassword(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(s){let{error:e}=(0,o.h)(s);return r.rejectWithValue(e)}}),p=(0,n.zD)("auth/logout",async(e,r)=>{try{let e=await t.logout();if(e&&e.data)return e.data;throw Error("No data found")}catch(s){let{error:e}=(0,o.h)(s);return r.rejectWithValue(e)}}),m=(0,n.Z0)({name:"auth",initialState:{loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,r)=>{e.error=null,e.loading=!1,l.A.set("accessToken",r.payload.accessToken,d),l.A.set("refreshToken",r.payload.refreshToken,d)}).addCase(c.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,r)=>{e.error=null,e.loading=!1,l.A.set("accessToken",r.payload.accessToken,d),l.A.set("refreshToken",r.payload.refreshToken,d)}).addCase(i.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(h.pending,e=>{e.loading=!0,e.error=null}).addCase(h.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(h.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(u.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(p.pending,e=>{e.loading=!0,e.error=null}).addCase(p.fulfilled,e=>{e.error=null,e.loading=!1,l.A.remove("accessToken"),l.A.remove("refreshToken")}).addCase(p.rejected,(e,r)=>{e.error=r.payload,e.loading=!1})}}),{}=m.actions,g=m.reducer},4622:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>u});var a=s(5155),t=s(2115),o=s(5695),n=s(5038),l=s(6874),d=s.n(l),i=s(9224),c=s(3426);function u(){let e=(0,o.useRouter)(),r=(0,i.CU)(),s=(0,o.useSearchParams)().get("token"),[l,u]=(0,t.useState)({password:"",confirmPassword:""}),[h,p]=(0,t.useState)(""),[m,g]=(0,t.useState)(!1),[w,f]=(0,t.useState)(!1),y=e=>{let{name:r,value:s}=e.target;u(e=>({...e,[r]:s}))},v=async a=>{if(a.preventDefault(),p(""),l.password.length<8){p("Password must be at least 8 characters long");return}if(l.password!==l.confirmPassword){p("Passwords do not match");return}if(!s){p("Invalid password reset token");return}g(!0);try{let a=await r.dispatch((0,c.ms)({resetToken:s,newPassword:l.password}));c.ms.fulfilled.match(a)&&(f(!0),setTimeout(()=>{e.push("/login")},2e3))}catch(e){p("Failed to reset password. Please try again.")}finally{g(!1)}};return(0,a.jsx)(t.Suspense,{fallback:"Loading...",children:(0,a.jsx)("div",{className:"min-h-[90vh] bg-[#F7F3F4] flex items-center justify-center px-4",children:(0,a.jsx)(n.P.div,{className:"w-full max-w-md",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6}}},children:(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-center text-3xl font-bold text-[#B73B45] mb-3",children:"Reset Password"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:w?"Password reset successful! Redirecting...":"Please enter your new password below"})]}),h&&(0,a.jsx)(n.P.div,{className:"bg-red-50 text-red-600 p-4 rounded-lg mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:h}),w?(0,a.jsxs)(n.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"bg-green-50 p-6 rounded-lg text-center",children:[(0,a.jsx)("svg",{className:"w-12 h-12 text-green-500 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,a.jsx)("p",{className:"mt-3 text-green-800 font-medium",children:"Password reset successful!"}),(0,a.jsx)("p",{className:"text-green-600 text-sm",children:"Redirecting you to login..."})]}):(0,a.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,a.jsx)(n.P.input,{whileFocus:{scale:1.01},transition:{duration:.2},type:"password",id:"password",name:"password",value:l.password,onChange:y,required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-[#B73B45] focus:outline-none focus:ring-1 focus:ring-[#B73B45]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,a.jsx)(n.P.input,{whileFocus:{scale:1.01},transition:{duration:.2},type:"password",id:"confirmPassword",name:"confirmPassword",value:l.confirmPassword,onChange:y,required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-[#B73B45] focus:outline-none focus:ring-1 focus:ring-[#B73B45]"})]}),(0,a.jsx)(n.P.button,{variants:{hover:{scale:1.05},tap:{scale:.95},disabled:{opacity:.6}},whileHover:"hover",whileTap:"tap",disabled:m,animate:m?"disabled":"",type:"submit",className:"w-full bg-[#B73B45] text-white py-3 rounded-full font-medium shadow-md hover:shadow-lg transition-all",children:m?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Resetting Password"]}):"Reset Password"}),(0,a.jsx)("div",{className:"text-center mt-4",children:(0,a.jsx)(d(),{href:"/login",className:"text-[#B73B45] text-sm hover:underline",children:"Return to login"})})]})]})})})})})}},5327:(e,r,s)=>{"use strict";s.d(r,{u:()=>o});var a=s(3464),t=s(7383);let o=a.A.create({baseURL:"https://cosmo-crystals-backend-6.onrender.com/api/v1",headers:{"Content-Type":"application/json"}});o.interceptors.request.use(async e=>{let r=t.A.get("accessToken");return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,async e=>{var r,s;let a=e.config;if((null===(r=e.response)||void 0===r?void 0:r.status)===401&&(t.A.remove("accessToken"),(null===(s=e.response)||void 0===s?void 0:s.status)===401&&!a._retry)){a._retry=!0;let e=await n();if(e)return a.headers.Authorization="Bearer ".concat(e),o(a)}return Promise.reject(e)});let n=async()=>{try{var e;let r=t.A.get("refreshToken");if(!r)throw Error("No refresh token available");let s=await a.A.post("".concat("https://cosmo-crystals-backend-6.onrender.com/api/v1","/auth/refresh/"),{refreshToken:r}),o=null===(e=s.data)||void 0===e?void 0:e.accessToken;return t.A.set("accessToken",o,{secure:!0}),o}catch(e){return t.A.remove("accessToken"),null}}},5695:(e,r,s)=>{"use strict";var a=s(8999);s.o(a,"useRouter")&&s.d(r,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(r,{useSearchParams:function(){return a.useSearchParams}})},9224:(e,r,s)=>{"use strict";s.d(r,{CU:()=>t});var a=s(4540);a.wA.withTypes(),a.d4.withTypes();let t=a.Pj.withTypes()},9945:(e,r,s)=>{"use strict";s.d(r,{h:()=>t});var a=s(6671);let t=e=>{if(!e.response)return a.oR.error("Network error occurred"),{error:{network:["Network error occurred"]},toastMessage:"Network error occurred"};let{data:r,status:s}=e.response;try{let e={};if("object"==typeof r&&null!==r)return(null==r?void 0:r.detail)&&(e.detail=[null==r?void 0:r.detail]),"string"==typeof(null==r?void 0:r.error)&&a.oR.error(null==r?void 0:r.error),(null==r?void 0:r.message)&&(e.message=[null==r?void 0:r.message]),Array.isArray(null==r?void 0:r.error)&&(null==r||r.error.map(e=>{a.oR.error((null==e?void 0:e.message)||e)})),{error:Array.isArray(null==r?void 0:r.error)?null==r?void 0:r.error.filter(e=>void 0!==e):[null==r?void 0:r.error].filter(e=>void 0!==e),toastMessage:400===s?"Please correct the errors and try again":"An error occurred"}}catch(e){console.error("Error parsing API response:",e)}return{error:{general:["An unexpected error occurred"]},toastMessage:"An unexpected error occurred"}}}},e=>{var r=r=>e(e.s=r);e.O(0,[122,874,405,38,441,684,358],()=>r(1433)),_N_E=e.O()}]);