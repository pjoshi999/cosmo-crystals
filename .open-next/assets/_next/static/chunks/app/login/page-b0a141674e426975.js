(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{1588:(e,r,t)=>{"use strict";t.d(r,{default:()=>l,q:()=>n});var a=t(5155),o=t(432),s=t(6715);let n=new o.E({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:3,staleTime:6e4,gcTime:0,throwOnError:!1},mutations:{retry:!1,throwOnError:!0}}});function l(e){let{children:r}=e;return(0,a.jsxs)(s.Ht,{client:n,children:[r,!1]})}},1890:(e,r,t)=>{"use strict";t.d(r,{L:()=>s,z:()=>o});var a=t(5327);let o={all:["cart"],lists:()=>[...o.all,"list"]},s=async()=>{let{data:e}=await a.u.get("/cart/");return e}},3426:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>m,Au:()=>h,Bi:()=>c,ms:()=>u,ug:()=>d});var a=t(5327);let o={signup:async e=>a.u.post("/auth/signup",e),login:async e=>a.u.post("/auth/login",e),resetPassword:async e=>a.u.post("/auth/reset-password",e),forgotPassword:async e=>a.u.post("/auth/forgot-password",e),logout:async()=>a.u.post("/auth/logout")};var s=t(9945),n=t(1990),l=t(7383);let i={expires:30,secure:!0},d=(0,n.zD)("auth/signup",async(e,r)=>{try{let r=await o.signup(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),c=(0,n.zD)("auth/login",async(e,r)=>{try{let r=await o.login(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),u=(0,n.zD)("auth/resetPassword",async(e,r)=>{try{let r=await o.resetPassword(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),h=(0,n.zD)("auth/forgotPassword",async(e,r)=>{try{let r=await o.forgotPassword(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),p=(0,n.zD)("auth/logout",async(e,r)=>{try{let e=await o.logout();if(e&&e.data)return e.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),f=(0,n.Z0)({name:"auth",initialState:{loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,r)=>{e.error=null,e.loading=!1,l.A.set("accessToken",r.payload.accessToken,i),l.A.set("refreshToken",r.payload.refreshToken,i)}).addCase(c.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,r)=>{e.error=null,e.loading=!1,l.A.set("accessToken",r.payload.accessToken,i),l.A.set("refreshToken",r.payload.refreshToken,i)}).addCase(d.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(h.pending,e=>{e.loading=!0,e.error=null}).addCase(h.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(h.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(u.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(p.pending,e=>{e.loading=!0,e.error=null}).addCase(p.fulfilled,e=>{e.error=null,e.loading=!1,l.A.remove("accessToken"),l.A.remove("refreshToken")}).addCase(p.rejected,(e,r)=>{e.error=r.payload,e.loading=!1})}}),{}=f.actions,m=f.reducer},4503:(e,r,t)=>{"use strict";t.d(r,{YQ:()=>d,uV:()=>u,DP:()=>c});var a=t(1890),o=t(1588),s=t(5327);let n={addToCart:async e=>s.u.post("/cart",e),updateCart:async e=>s.u.patch("/cart",e),removeFromCart:async e=>s.u.delete("/cart/".concat(e.productId))};var l=t(9945),i=t(1990);let d=(0,i.zD)("cart/addToCart",async(e,r)=>{try{let r=await n.addToCart(e);if(r&&r.data)return o.q.invalidateQueries({queryKey:a.z.lists()}),r.data;throw Error("No data found")}catch(t){let{error:e}=(0,l.h)(t);return r.rejectWithValue(e)}}),c=(0,i.zD)("cart/updateCart",async(e,r)=>{try{let r=await n.updateCart(e);if(r&&r.data)return o.q.invalidateQueries({queryKey:a.z.lists()}),r.data;throw Error("No data found")}catch(t){let{error:e}=(0,l.h)(t);return r.rejectWithValue(e)}}),u=(0,i.zD)("cart/removeFromCart",async(e,r)=>{try{let r=await n.removeFromCart(e);if(r&&r.data)return o.q.invalidateQueries({queryKey:a.z.lists()}),r.data;throw Error("No data found")}catch(t){let{error:e}=(0,l.h)(t);return r.rejectWithValue(e)}}),h=(0,i.Z0)({name:"auth",initialState:{loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(d.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(c.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(u.rejected,(e,r)=>{e.error=r.payload,e.loading=!1})}}),{}=h.actions;h.reducer},5327:(e,r,t)=>{"use strict";t.d(r,{u:()=>s});var a=t(3464),o=t(7383);let s=a.A.create({baseURL:"https://cosmo-crystals-backend-6.onrender.com/api/v1",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(async e=>{let r=o.A.get("accessToken");return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var r,t;let a=e.config;if((null===(r=e.response)||void 0===r?void 0:r.status)===401&&(o.A.remove("accessToken"),(null===(t=e.response)||void 0===t?void 0:t.status)===401&&!a._retry)){a._retry=!0;let e=await n();if(e)return a.headers.Authorization="Bearer ".concat(e),s(a)}return Promise.reject(e)});let n=async()=>{try{var e;let r=o.A.get("refreshToken");if(!r)throw Error("No refresh token available");let t=await a.A.post("".concat("https://cosmo-crystals-backend-6.onrender.com/api/v1","/auth/refresh/"),{refreshToken:r}),s=null===(e=t.data)||void 0===e?void 0:e.accessToken;return o.A.set("accessToken",s,{secure:!0}),s}catch(e){return o.A.remove("accessToken"),null}}},5423:(e,r,t)=>{Promise.resolve().then(t.bind(t,9690))},5695:(e,r,t)=>{"use strict";var a=t(8999);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},8126:(e,r)=>{"use strict";function t(){return null}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return t}}),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},9224:(e,r,t)=>{"use strict";t.d(r,{CU:()=>o});var a=t(4540);a.wA.withTypes(),a.d4.withTypes();let o=a.Pj.withTypes()},9690:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var a=t(5155),o=t(2115),s=t(6874),n=t.n(s),l=t(5695),i=t(2243),d=t(8126),c=t.n(d),u=t(3426),h=t(9224),p=t(4503),f=t(6671);function m(){let e=(0,l.useRouter)(),r=(0,h.CU)(),[t,s]=(0,o.useState)(""),[d,m]=(0,o.useState)(""),[g,y]=(0,o.useState)(!1),[v,w]=(0,o.useState)(""),[x,j]=(0,o.useState)(null),C={initial:{y:20,opacity:0},animate:{y:0,opacity:1,transition:{duration:.6}}},b={animate:{transition:{staggerChildren:.1}}};(0,o.useEffect)(()=>{let e=localStorage.getItem("cartPendingAction");if(e)try{j(JSON.parse(e))}catch(e){console.error("Error parsing pending cart action",e),localStorage.removeItem("cartPendingAction")}},[]);let N=async a=>{a.preventDefault(),w(""),y(!0);try{let a=await r.dispatch((0,u.Bi)({email:t,password:d}));if(u.Bi.fulfilled.match(a)){if(x){let t=await r.dispatch((0,p.YQ)({productId:null==x?void 0:x.productId,quantity:null==x?void 0:x.quantity}));p.YQ.fulfilled.match(t)&&f.oR.success("Product added to cart successfully!"),e.push("/")}else e.push("/");localStorage.removeItem("cartPendingAction")}}catch(e){w("Invalid email or password. Please try again.")}finally{y(!1)}};return(0,a.jsxs)(i.P.div,{className:"min-h-[90vh] bg-[#F7F3F4] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",initial:"initial",animate:"animate",exit:"exit",variants:{initial:{opacity:0},animate:{opacity:1,transition:{duration:.6}},exit:{opacity:0,transition:{duration:.4}}},children:[(0,a.jsxs)(c(),{children:[(0,a.jsx)("title",{children:"Login | Cosmo Crystals"}),(0,a.jsx)("meta",{name:"description",content:"Sign In to your Cosmo Crystals account"})]}),(0,a.jsx)("div",{className:"max-w-md w-full",children:(0,a.jsxs)(i.P.div,{className:"bg-white rounded-2xl shadow-lg overflow-hidden p-8",variants:b,children:[(0,a.jsxs)(i.P.div,{variants:C,children:[(0,a.jsx)("h2",{className:"text-center text-3xl font-bold text-[#B73B45] mb-6",children:"Sign In"}),(0,a.jsx)("p",{className:"text-center text-gray-600 mb-8",children:"Welcome back to Cosmo Crystals"})]}),v&&(0,a.jsx)(i.P.div,{className:"bg-red-50 text-red-600 p-4 rounded-lg mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:v}),(0,a.jsx)("form",{onSubmit:N,children:(0,a.jsxs)(i.P.div,{className:"space-y-6",variants:b,children:[(0,a.jsxs)(i.P.div,{variants:C,children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t,onChange:e=>s(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-full focus:ring-[#B73B45] focus:border-[#B73B45] focus:outline-none transition-all",placeholder:"your@email.com"})]}),(0,a.jsxs)(i.P.div,{variants:C,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsx)(n(),{href:"/forgot-password",className:"text-sm text-[#B73B45] hover:text-[#8A2A33] transition-colors",children:"Forgot password?"})]}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:d,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-full focus:ring-[#B73B45] focus:border-[#B73B45] focus:outline-none transition-all",placeholder:"••••••••"})]}),(0,a.jsx)(i.P.div,{variants:C,children:(0,a.jsx)(i.P.button,{type:"submit",disabled:g,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full bg-[#B73B45] text-white py-3 px-4 rounded-full shadow-md hover:shadow-lg transition-all focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#B73B45] disabled:opacity-70",children:g?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]})}),(0,a.jsxs)(i.P.div,{className:"mt-8 text-center text-sm text-gray-600",variants:C,children:["Don't have an account?"," ",(0,a.jsx)(n(),{href:"/register",className:"font-medium text-[#B73B45] hover:text-[#8A2A33] transition-colors",children:"Sign up today!"})]})]})})]})}},9945:(e,r,t)=>{"use strict";t.d(r,{h:()=>o});var a=t(6671);let o=e=>{if(!e.response)return a.oR.error("Network error occurred"),{error:{network:["Network error occurred"]},toastMessage:"Network error occurred"};let{data:r,status:t}=e.response;try{let e={};if("object"==typeof r&&null!==r)return(null==r?void 0:r.detail)&&(e.detail=[null==r?void 0:r.detail]),"string"==typeof(null==r?void 0:r.error)&&a.oR.error(null==r?void 0:r.error),(null==r?void 0:r.message)&&(e.message=[null==r?void 0:r.message]),Array.isArray(null==r?void 0:r.error)&&(null==r||r.error.map(e=>{a.oR.error((null==e?void 0:e.message)||e)})),{error:Array.isArray(null==r?void 0:r.error)?null==r?void 0:r.error.filter(e=>void 0!==e):[null==r?void 0:r.error].filter(e=>void 0!==e),toastMessage:400===t?"Please correct the errors and try again":"An error occurred"}}catch(e){console.error("Error parsing API response:",e)}return{error:{general:["An unexpected error occurred"]},toastMessage:"An unexpected error occurred"}}}},e=>{var r=r=>e(e.s=r);e.O(0,[122,874,967,243,405,432,441,684,358],()=>r(5423)),_N_E=e.O()}]);