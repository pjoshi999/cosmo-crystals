(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},1588:(e,r,t)=>{"use strict";t.d(r,{default:()=>l,q:()=>n});var a=t(5155),o=t(432),s=t(6715);let n=new o.E({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:3,staleTime:6e4,gcTime:0,throwOnError:!1},mutations:{retry:!1,throwOnError:!0}}});function l(e){let{children:r}=e;return(0,a.jsxs)(s.Ht,{client:n,children:[r,!1]})}},3426:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>p,Au:()=>h,Bi:()=>u,ms:()=>c,ug:()=>i});var a=t(5327);let o={signup:async e=>a.u.post("/auth/signup",e),login:async e=>a.u.post("/auth/login",e),resetPassword:async e=>a.u.post("/auth/reset-password",e),forgotPassword:async e=>a.u.post("/auth/forgot-password",e),logout:async()=>a.u.post("/auth/logout")};var s=t(9945),n=t(1990),l=t(7383);let d={expires:30,secure:!0},i=(0,n.zD)("auth/signup",async(e,r)=>{try{let r=await o.signup(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),u=(0,n.zD)("auth/login",async(e,r)=>{try{let r=await o.login(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),c=(0,n.zD)("auth/resetPassword",async(e,r)=>{try{let r=await o.resetPassword(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),h=(0,n.zD)("auth/forgotPassword",async(e,r)=>{try{let r=await o.forgotPassword(e);if(r&&r.data)return r.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),f=(0,n.zD)("auth/logout",async(e,r)=>{try{let e=await o.logout();if(e&&e.data)return e.data;throw Error("No data found")}catch(t){let{error:e}=(0,s.h)(t);return r.rejectWithValue(e)}}),g=(0,n.Z0)({name:"auth",initialState:{loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,(e,r)=>{e.error=null,e.loading=!1,l.A.set("accessToken",r.payload.accessToken,d),l.A.set("refreshToken",r.payload.refreshToken,d)}).addCase(u.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,r)=>{e.error=null,e.loading=!1,l.A.set("accessToken",r.payload.accessToken,d),l.A.set("refreshToken",r.payload.refreshToken,d)}).addCase(i.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(h.pending,e=>{e.loading=!0,e.error=null}).addCase(h.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(h.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,e=>{e.error=null,e.loading=!1}).addCase(c.rejected,(e,r)=>{e.error=r.payload,e.loading=!1}),e.addCase(f.pending,e=>{e.loading=!0,e.error=null}).addCase(f.fulfilled,e=>{e.error=null,e.loading=!1,l.A.remove("accessToken"),l.A.remove("refreshToken")}).addCase(f.rejected,(e,r)=>{e.error=r.payload,e.loading=!1})}}),{}=g.actions,p=g.reducer},4147:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_4d318d",variable:"__variable_4d318d"}},5327:(e,r,t)=>{"use strict";t.d(r,{u:()=>s});var a=t(3464),o=t(7383);let s=a.A.create({baseURL:"https://cosmo-crystals-backend-6.onrender.com/api/v1",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(async e=>{let r=o.A.get("accessToken");return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var r,t;let a=e.config;if((null===(r=e.response)||void 0===r?void 0:r.status)===401&&(o.A.remove("accessToken"),(null===(t=e.response)||void 0===t?void 0:t.status)===401&&!a._retry)){a._retry=!0;let e=await n();if(e)return a.headers.Authorization="Bearer ".concat(e),s(a)}return Promise.reject(e)});let n=async()=>{try{var e;let r=o.A.get("refreshToken");if(!r)throw Error("No refresh token available");let t=await a.A.post("".concat("https://cosmo-crystals-backend-6.onrender.com/api/v1","/auth/refresh/"),{refreshToken:r}),s=null===(e=t.data)||void 0===e?void 0:e.accessToken;return o.A.set("accessToken",s,{secure:!0}),s}catch(e){return o.A.remove("accessToken"),null}}},6309:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,4147,23)),Promise.resolve().then(t.t.bind(t,8489,23)),Promise.resolve().then(t.t.bind(t,347,23)),Promise.resolve().then(t.bind(t,1588)),Promise.resolve().then(t.bind(t,9452))},8489:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_ea5f4b",variable:"__variable_ea5f4b"}},9452:(e,r,t)=>{"use strict";t.d(r,{default:()=>u});var a=t(5155),o=t(1990),s=t(3426);let n=()=>(0,o.U1)({reducer:{auth:s.Ay}});var l=t(2115),d=t(4540),i=t(6671);function u(e){let{children:r}=e,t=(0,l.useRef)(null);return t.current||(t.current=n()),(0,a.jsxs)(d.Kq,{store:t.current,children:[(0,a.jsx)(i.l$,{position:"bottom-right",visibleToasts:1,toastOptions:{classNames:{error:"bg-[#8A2A33] rounded-xl w-fit right-0 text-white text-base border-none"},className:"bg-[#6750A4] rounded-xl w-fit right-0 text-white text-base border-none"}}),r]})}},9945:(e,r,t)=>{"use strict";t.d(r,{h:()=>o});var a=t(6671);let o=e=>{if(!e.response)return a.oR.error("Network error occurred"),{error:{network:["Network error occurred"]},toastMessage:"Network error occurred"};let{data:r,status:t}=e.response;try{let e={};if("object"==typeof r&&null!==r)return(null==r?void 0:r.detail)&&(e.detail=[null==r?void 0:r.detail]),"string"==typeof(null==r?void 0:r.error)&&a.oR.error(null==r?void 0:r.error),(null==r?void 0:r.message)&&(e.message=[null==r?void 0:r.message]),Array.isArray(null==r?void 0:r.error)&&(null==r||r.error.map(e=>{a.oR.error((null==e?void 0:e.message)||e)})),{error:Array.isArray(null==r?void 0:r.error)?null==r?void 0:r.error.filter(e=>void 0!==e):[null==r?void 0:r.error].filter(e=>void 0!==e),toastMessage:400===t?"Please correct the errors and try again":"An error occurred"}}catch(e){console.error("Error parsing API response:",e)}return{error:{general:["An unexpected error occurred"]},toastMessage:"An unexpected error occurred"}}}},e=>{var r=r=>e(e.s=r);e.O(0,[896,122,967,405,432,441,684,358],()=>r(6309)),_N_E=e.O()}]);